/*!
 * BetTrackr Chrome Extension (c) 2025 BetTrackr Pty Ltd
 * Licensed for use with a valid BetTrackr account only.
 * Reverse engineering or modification is prohibited.
 */
const betfair={bookmaker_name:"Betfair",balance:'tr[rel="main-wallet"] td.ssc-wla[rel="main"]',pages:{"*":{button:".place-bet-panel",filter:function(t){return!0},fields:{bet_type:async function(t){return t.hasClass("lay")?"Lay Bet":"Qualifying Bet"},stake:async function(t){return t[0].querySelector(".size-input").value},odds:async function(t){return t[0].querySelector(".price-input").value},selection:async function(t){return t.find(".bet-info-description").children().first().text()},runner:async function(t){return t.find(".bet-info-description").children().first().text()},date_placed:async function(t){return""},status:async function(t){return"Pending"},date_resulted:async function(t){return""},betfair_market_id:async function(t){const e=t.closest("tr").prev().find("td:first a");return e.length?e.data("market-id")+"":""},betfair_event_id:async function(t){const e=t.closest("tr").prev().find("td:first a");return e.length?e.data("event-or-meeting-id"):""},bookmaker_internal_id:async function(t){if(t.text().includes("Ref: ")){const e=t.text().match(/Ref:\s*(\d+)/);return e?e[1]:null}return""}}},market:{button:"betslip-potential-bet, betslip-bet",filter:function(t){return!0},fields:{bet_type:async function(t){let e=t.closest('div[ng-if^="$ctrl.hasPotential"]');return 0===e.length&&(e=t.closest('div[ng-if="$ctrl.hasMatchedBackBets"]')),e.find(".betslip-bets-header__cell").first().text().trim().includes("Back (Bet For)")?"Qualifying Bet":"Lay Bet"},stake:async function(t){const e=t[0].querySelector(".betslip-size-input");if(e)return e.value;const n=t.find(".betslip-bet__runner-details .betslip-bet__runner-detail");return 2>n.length?void 0:n.eq(1).text().trim()},odds:async function(t){const e=t[0].querySelector(".betslip-price-ladder__input");if(e)return e.value;const n=t.find(".betslip-bet__runner-details .betslip-bet__runner-detail");return 2>n.length?void 0:n.eq(0).text().trim()},selection:async function(t){return getFirstMatchText(t,['[ng-bind="$ctrl.bet.runner.name"]'],((t,e,n)=>t.trim()),"")},runner:async function(t){return getFirstMatchText(t,['[ng-bind="$ctrl.bet.runner.name"]'],((t,e,n)=>t.trim()),"")},date_placed:async function(t){return""},status:async function(t){return"Pending"},date_resulted:async function(t){return""},bookmaker_internal_id:async function(t){if(t.text().includes("Ref: ")){const e=t.text().match(/Ref:\s*(\d+)/);return e?e[1]:null}return""},is_racing:async function(t){return location.href.includes("racing")},betfair_market_id:async function(t){return window.location.pathname.split("/").pop()}}}}};function waitForCommissionText(t,e=5e3){const n=e/100;let r=0;const i=setInterval((()=>{const e=document.querySelector(".dialog-container");if(e&&"none"!==getComputedStyle(e).display){const n=e.querySelector("span");if(n&&n.textContent.includes("% Market Base Rate")){clearInterval(i);const e=n.textContent.trim().match(/\d+%/);t(e?e[0]:null)}}++r<n||(clearInterval(i),t(null))}),100)}$("<style>").prop("type","text/css").html(".bets-container, .page-content:not(.front-pages), .page-content.nested-scrollable-pane-parent:not(.front-pages) > .bf-row, .place-bet-panel { overflow: visible !important; }").appendTo("head");