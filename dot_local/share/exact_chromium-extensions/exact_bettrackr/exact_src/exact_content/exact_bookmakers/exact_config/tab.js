/*!
 * BetTrackr Chrome Extension (c) 2025 BetTrackr Pty Ltd
 * Licensed for use with a valid BetTrackr account only.
 * Reverse engineering or modification is prohibited.
 */
const tab={bookmaker_name:"Tab",balance:'[data-testid="show-balance"',pages:{"*":{button:".bet-card",fields:{bet_type:async function(t){return"Qualifying Bet"},stake:async function(t){return getFirstMatchText(t,['[data-id="bet-stake"]',".bet-info-value.bet-stake",".bet-stake",".bet-card-body"],(function(t,e,n){return".bet-stake"==n||".bet-card-body"==n?extractValueAfterLabel(e,"Stake"):t}))},odds:async function(t){return getFirstMatchText(t,[".bet-odds",".combined-price",".bet-card-body"],(function(t,e,n){return".bet-card-body"==n?extractValueAfterLabel(e,"Odds"):t.replace("Win ","")}))},selection:async function(t){let e="";return e=t.find("label.bet-info-label").filter((function(){return"Combined Price"===$(this).text().trim()})).length?t.find("header").text():t.find(".bet-card-title").text().trim(),e},date_placed:async function(t){return""},status:async function(t){return"Pending"},date_resulted:async function(t){return""},bookmaker_internal_id:async function(t){return getFirstMatchText(t,[".bet-status-info"],(function(t,e,n){return""}))},is_racing:async function(t){return getFirstMatchText(t,[".bet-card-race-information","ul.bet-card-info-list > li:eq(1)"],(function(t,e,n){return t.includes("Race")}))},track:async function(t){return getFirstMatchText(t,[".bet-card-race-information","ul.bet-card-info-list > li:eq(1)",".bet-card-title"],(function(t,e,n){return t.split("(")[0].trim()}))},race:async function(t){return getFirstMatchText(t,[".bet-card-race-information","ul.bet-card-info-list > li:eq(1)",".bet-card-title"],(function(t,e,n){const i=t.split("-");return i.length>1?parseInt(i[1].replace("Race","").trim()):0}),0)},runner:async function(t){let e="";return e=t.find("label.bet-info-label").filter((function(){return"Combined Price"===$(this).text().trim()})).length?t.find("header").text():t.find(".bet-card-title").text().trim(),getRunnerFromSelection(e).replace(".","")},event_name:async function(t){return getFirstMatchText(t,[".bet-card-match-name","ul.bet-card-info-list > li:eq(1)",".bet-card-title"],(function(t,e,n){const i=t.split("-");if(2>i.length)return t;const r=i[0].split(" "),a=i[1].split(" ")[0];return`${r[r.length-1]} v ${a}`.replace("City","")}))},sport:async function(t){return getFirstMatchText(t,[".bet-card-competition-name","ul.bet-card-info-list > li:eq(1)",".bet-card-title"],(function(t,e,n){return".bet-card-competition-name"==n?t:t.split(" ")[0]}))}}},bets:{button:'[data-testid^="my-bets-bet-card-"]',fields:{bet_type:async function(t){return"Qualifying Bet"},stake:async function(t){return t.find('[data-testid="bet-card-stake"]').text().trim().replace("$","")},odds:async function(t){return t.find('[data-testid="bet-card-odds"]').text().trim()},selection:async function(t){return t.find('[data-testid="bet-card-runner-name"]').text().trim()},date_placed:async function(t){let e=t.find('[data-testid="bet-card-date"]').text().trim();const n=(new Date).getFullYear(),i=e.split(" - ")[0].slice(4);let r=new Date(i+" "+n);const a=r.getTimezoneOffset();return r=new Date(r.getTime()-6e4*a),r.toISOString().split("T")[0]},status:async function(t){let e=t.find('[data-testid="bet-card-result"]').text().trim();return"Won"==e||"Pending"==e||"Void"==e?e:"Lost"},date_resulted:async function(t){let e=t.find('[data-testid="bet-card-date"]').text().trim();const n=(new Date).getFullYear(),i=e.split(" - ")[0].slice(4);let r=new Date(i+" "+n);const a=r.getTimezoneOffset();return r=new Date(r.getTime()-6e4*a),r.toISOString().split("T")[0]},bookmaker_internal_id:async function(t){let e=t;return(await toggleTSN(e,'[data-testid="bet-card-tsn"]')).text()},is_racing:async function(t){let e=t.find('[data-testid="bet-card-event-name"]').text().trim();return/\sR\d+\s/.test(e)},track:async function(t){return t.find('[data-testid="bet-card-event-name"]').text().trim().split(/\sR\d+\s/)[0]},runner:async function(t){let e=t.find('[data-testid="bet-card-runner-name"]').text().trim();return getRunnerFromSelection(e).replace(".","")},event_name:async function(t){const e=t.find('[data-testid="bet-card-event-name"]').text().trim().split("-"),n=e[0].split(" "),i=e[1].split(" ")[0];return`${n[n.length-1]} v ${i}`.replace("City","")},event_date:async function(t){let e=(await toggleTSN(t,'[data-testid="bet-card-event-date"]')).text().trim();const n=(new Date).getFullYear(),i=e.split(" - ")[0].slice(4);let r=new Date(i+" "+n);const a=r.getTimezoneOffset();return r=new Date(r.getTime()-6e4*a),r.toISOString().split("T")[0]}}}}};function extractValueAfterLabel(t,e){const n=t.find("label.bet-info-label").filter((function(){return $(this).text().trim()===e}));return 0===n.length?null:n.closest(".column").find(".bet-details").first().text()}async function toggleTSN(t,e){const n=t.find(e);if(0===n.length){const n=t.find('[data-testid="bet-card-bet-type"]');if(0===n.length)throw Error("Bet card type button not found");return n.click(),await new Promise((t=>setTimeout(t,500))),t.find(e)}return n}